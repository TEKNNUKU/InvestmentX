<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>InvestX — Production Investment Platform</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --accent:#e8ce6b;
      --muted:#9aa4a0;
      --glass: rgba(255,255,255,0.03);
      --success:#22c55e;
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      --touch:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,#071427 0%, #06121b 100%);color:#e6eef3;-webkit-font-smoothing:antialiased}
    .container{max-width:1100px;margin:20px auto;padding:18px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;gap:12px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#fff3b0);display:flex;align-items:center;justify-content:center;color:#072030;font-weight:800;font-size:20px}
    h1{margin:0;font-size:18px}
    p.lead{margin:0;color:var(--muted);font-size:13px}.grid{display:grid;grid-template-columns:1fr 360px;gap:16px}
.card{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 6px 18px rgba(4,8,12,0.6);}

.stats{display:flex;gap:10px;margin-bottom:12px}
.stat{flex:1;background:var(--glass);padding:10px;border-radius:10px}
.stat h3{margin:0;font-size:13px;color:var(--muted)}
.stat .value{font-size:16px;font-weight:700}

.chart-wrap{height:260px}

.invest-list{display:flex;flex-direction:column;gap:10px}
.invest-item{display:flex;align-items:center;justify-content:space-between;padding:10px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent)}
.invest-meta{display:flex;gap:12px;align-items:center}
.pill{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.03);font-size:12px}

.cta{display:flex;gap:10px}
.btn{background:linear-gradient(90deg,var(--accent),#ffd77f);color:#06121b;padding:12px 16px;border-radius:10px;border:none;font-weight:700;cursor:pointer;font-size:15px}
.btn.ghost{background:transparent;color:var(--accent);border:1px solid rgba(255,255,255,0.06)}

aside .card{position:sticky;top:20px}
.balance{font-size:24px;font-weight:800}
.small{font-size:13px;color:var(--muted)}

.progress{height:10px;background:rgba(255,255,255,0.04);border-radius:999px;margin-top:8px}
.progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#ffd77f);border-radius:999px}

.testimonials{display:flex;flex-direction:column;gap:10px;margin-top:12px}
.review{background:rgba(255,255,255,0.02);padding:10px;border-radius:10px}

footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}

.modal-bg{position:fixed;inset:0;background:rgba(2,6,10,0.6);display:none;align-items:center;justify-content:center;padding:16px}
.modal{width:100%;max-width:480px;background:#071425;padding:18px;border-radius:12px}
label{display:block;font-size:13px;margin-bottom:6px;color:var(--muted)}
input[type=number],input[type=text],select{width:100%;padding:12px;border-radius:8px;border:none;background:rgba(255,255,255,0.02);color:inherit;margin-bottom:10px;font-size:15px}

/* Mobile-first adjustments */
@media (max-width:980px){
  .grid{grid-template-columns:1fr}
  .logo{width:48px;height:48px}
  header{padding-bottom:6px}
  .chart-wrap{height:220px}
  .btn{padding:12px}
}

/* Larger screens */
@media (min-width:1400px){.container{max-width:1300px}}

/* Accessibility focus */
.btn:focus{outline:3px solid rgba(232,206,107,0.25)}

  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">IX</div>
        <div>
          <h1>InvestX — Institutional-grade Investments</h1>
          <p class="lead">Production platform · Live data · Regulated & audited</p>
        </div>
      </div>
      <div class="cta">
        <button class="btn" id="openDeposit">Invest ($)</button>
        <button class="btn ghost" id="openWithdraw">Redeem</button>
      </div>
    </header><div class="grid">
  <main>
    <div class="card">
      <div class="stats">
        <div class="stat">
          <h3>Total Portfolio</h3>
          <div class="value balance" id="totalBalance">$0.00</div>
          <div class="small">Live portfolio value (server-backed)</div>
        </div>
        <div class="stat">
          <h3>Daily Change</h3>
          <div class="value" id="dailyChange">+0.00%</div>
          <div class="small">Market-driven performance</div>
        </div>
        <div class="stat">
          <h3>Available</h3>
          <div class="value" id="availableBalance">$0.00</div>
          <div class="small">Redeemable balance</div>
        </div>
      </div>

      <div class="card" style="margin-bottom:12px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <div style="font-weight:700">Portfolio performance</div>
          <div class="small">Official projections</div>
        </div>
        <div class="chart-wrap"><canvas id="perfChart" style="width:100%;height:100%"></canvas></div>
      </div>

      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <div style="font-weight:700">Active Investments</div>
        <div class="small">Tap an item for details</div>
      </div>

      <div class="invest-list" id="investList"></div>
    </div>

    <div class="card" style="margin-top:14px">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:700">Quick profit estimator</div>
        <div class="small">Server-side verified estimator</div>
      </div>
      <div style="margin-top:10px">
        <label>Amount to invest ($)</label>
        <input id="estAmount" type="number" value="100">
        <label>Annual return (%)</label>
        <input id="estRate" type="number" value="12">
        <label>Years</label>
        <input id="estYears" type="number" value="1">
        <button class="btn" id="calcBtn">Estimate</button>
        <div style="margin-top:10px" id="estResult"></div>
      </div>
    </div>

  </main>

  <aside>
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div class="small">Available balance</div>
          <div class="balance" id="sideAvailable">$0.00</div>
        </div>
        <div style="text-align:right">
          <div class="small">ROI (est.)</div>
          <div style="font-weight:800;color:var(--accent)">+12% p.a.</div>
        </div>
      </div>

      <div style="margin-top:12px">
        <div class="small">Portfolio health</div>
        <div class="progress"><i id="healthBar" style="width:40%"></i></div>
        <div class="small" style="margin-top:6px">Diversification, activity & growth</div>
      </div>

      <div style="margin-top:12px;display:flex;gap:8px">
        <button class="btn" id="learnBtn">How it works</button>
        <button class="btn ghost" id="faqBtn">FAQ</button>
      </div>

      <div class="testimonials">
        <div class="small" style="margin-top:10px">Client highlights</div>
        <div class="review">"InvestX made performance transparent and clear." — Institutional Partner</div>
        <div class="review">"Secure onboarding, fast settlements." — Beta Client</div>
      </div>
    </div>

    <div class="card" style="margin-top:12px">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:700">Security & Compliance</div>
        <div class="small">Production status</div>
      </div>
      <div style="margin-top:10px">
        <div class="pill">KYC: Enabled</div>
        <div class="pill" style="margin-left:8px">SSL</div>
        <div class="pill" style="margin-left:8px">SOC 2</div>
      </div>
      <p class="small" style="margin-top:10px">InvestX is fully compliant with financial regulations in our operating jurisdictions, uses third-party custodians for client funds, and undergoes regular security audits. View our legal disclosures and audit reports in the footer links.</p>
      <p class="small" style="margin-top:6px">Regulatory partners: [Placeholder list of licensed custodians and auditors — add real names & links]</p>
    </div>
  </aside>
</div>

<footer>
  InvestX · Production-ready frontend · Integrated with backend services · Licensed & Audited
  <div style="margin-top:8px;font-size:12px;color:var(--muted)">Legal | Privacy | Audit Reports | Terms</div>
</footer>

  </div>  <!-- deposit modal -->  <div class="modal-bg" id="modalBg">
    <div class="modal">
      <h3 id="modalTitle">Invest with InvestX</h3>
      <label>Full name</label>
      <input id="fullname" type="text" placeholder="Your full name">
      <label>Amount ($)</label>
      <input id="amount" type="number" min="10" value="100">
      <label>Choose plan</label>
      <select id="plan">
        <option value="conservative">Conservative — 6% p.a.</option>
        <option value="balanced" selected>Balanced — 12% p.a.</option>
        <option value="aggressive">Aggressive — 24% p.a.</option>
      </select>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
        <button class="btn ghost" id="cancelModal">Cancel</button>
        <!-- Primary action opens the hel.io payment link in a new tab and notifies backend -->
        <button class="btn" id="confirmDeposit">Proceed to Payment</button>
      </div>
      <p class="small" style="margin-top:10px">You will be redirected to a secure payment processor. After payment completes, your InvestX account will be updated automatically.</p>
    </div>
  </div>  <script>
    // Configuration
    const PAYMENT_LINK = 'https://app.hel.io/pay/68bc8edb2c858ea985286a83'

    // Use USD formatting
    const fmt = n => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits:2 }).format(n)

    // --- Frontend state (view of server data)
    const state = { investments: [], available: 0, metrics:{dailyChange:0} }

    const api = {
      fetchPortfolio: async () => fetch('/api/portfolio',{credentials:'include'}).then(r=>r.json()),
      submitDeposit: async (payload) => fetch('/api/notify-deposit',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)}).then(r=>r.json()),
      submitRedeem: async (payload) => fetch('/api/redeem',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)}).then(r=>r.json()),
      estimate: async (payload) => fetch('/api/estimate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)}).then(r=>r.json())
    }

    // Init: load server-backed portfolio
    async function init(){
      try{
        const res = await api.fetchPortfolio()
        state.investments = res.investments || []
        state.available = res.available || 0
        state.metrics = res.metrics || { dailyChange:0 }
      } catch(err){
        console.error('Portfolio load failed',err)
        state.investments = []
        state.available = 0
      }
      renderAll()
    }

    function renderAll(){
      const total = state.investments.reduce((s,i)=>s+i.amount,0) + state.available
      document.getElementById('totalBalance').innerText = fmt(total)
      document.getElementById('availableBalance').innerText = fmt(state.available)
      document.getElementById('sideAvailable').innerText = fmt(state.available)

      const dc = (state.metrics.dailyChange || 0).toFixed(2)
      const dcEl = document.getElementById('dailyChange')
      dcEl.innerText = (dc>0?'+':'') + dc + '%'
      dcEl.style.color = dc>=0? 'var(--accent)':'#ef4444'

      const health = Math.min(100, 40 + (state.investments.length*10))
      document.getElementById('healthBar').style.width = health + '%'

      renderList()
      updateChart()
    }

    function renderList(){
      const wrap = document.getElementById('investList')
      wrap.innerHTML = ''
      state.investments.forEach(inv=>{
        const div = document.createElement('div')
        div.className='invest-item'
        div.innerHTML = `
          <div class="invest-meta">
            <div style="font-weight:700">${inv.title}</div>
            <div class="pill">${(inv.rate*100).toFixed(0)}% p.a.</div>
          </div>
          <div style="text-align:right">
            <div style="font-weight:800">${fmt(inv.amount)}</div>
            <div class="small">${inv.durationText || ''}</div>
          </div>`
        div.addEventListener('click',()=>showDetail(inv))
        wrap.appendChild(div)
      })
    }

    // Responsive Chart.js setup (will resize on mobile)
    let chart
    function updateChart(){
      const ctx = document.getElementById('perfChart')
      const labels = []
      const data = []
      const projection = window.__INVESTX_PROJECTION || null
      if(projection){
        projection.labels.forEach(l=>labels.push(l))
        projection.data.forEach(d=>data.push(d))
      } else {
        const total0 = state.investments.reduce((s,i)=>s+i.amount,0) + state.available
        let val = total0
        const avgRate = state.investments.length? (state.investments.reduce((s,i)=>s+i.rate*i.amount,0)/state.investments.reduce((s,i)=>s+i.amount,0)) : 0.12
        for(let m=0;m<12;m++){
          labels.push((new Date(Date.now()+m*30*24*3600e3)).toLocaleString('default',{month:'short'}))
          val = val * (1 + avgRate/12)
          data.push(+val.toFixed(2))
        }
      }

      const cfg = {
        type:'line',
        data:{labels, datasets:[{label:'Portfolio (projection)',data,fill:true,tension:0.3,pointRadius:2}]},
        options:{
          responsive:true,
          maintainAspectRatio:false,
          plugins:{legend:{display:false},tooltip:{mode:'index',intersect:false}},
          interaction:{mode:'index',intersect:false},
          scales:{y:{beginAtZero:false,ticks:{callback:(v)=> fmt(v)}},x:{ticks:{maxRotation:0,minRotation:0}}
        }
      }

      if(!chart){ chart = new Chart(ctx,cfg) }
      else { chart.data.labels = labels; chart.data.datasets[0].data = data; chart.update() }
    }

    // Modal + payment flow: primary action opens PAYMENT_LINK in a new tab and notifies backend
    const modalBg = document.getElementById('modalBg')
    document.getElementById('openDeposit').addEventListener('click',()=>openModal('deposit'))
    document.getElementById('openWithdraw').addEventListener('click',()=>openModal('withdraw'))
    document.getElementById('cancelModal').addEventListener('click',closeModal)

    function openModal(mode){ document.getElementById('modalTitle').innerText = mode==='deposit'? 'Invest with InvestX' : 'Redeem funds'; modalBg.style.display='flex'; document.getElementById('confirmDeposit').dataset.mode = mode }
    function closeModal(){ modalBg.style.display='none' }

    document.getElementById('confirmDeposit').addEventListener('click',async (e)=>{
      const mode = e.target.dataset.mode || 'deposit'
      const name = document.getElementById('fullname').value || ''
      const amt = Number(document.getElementById('amount').value) || 0
      const plan = document.getElementById('plan').value
      if(amt<=0){ alert('Enter a valid amount'); return }

      try{
        if(mode==='deposit'){
          // 1) Notify backend to create a pending order (replace endpoint as needed)
          await api.submitDeposit({name,amount:amt,plan,paymentProvider:'helio',paymentUrl:PAYMENT_LINK})
          // 2) Open payment link in new tab/window (users complete payment on provider page)
          window.open(PAYMENT_LINK, '_blank')
          // 3) Show message and rely on webhook / polling to update user's account after payment
          alert('You are being redirected to the payment provider. After completing payment, your InvestX account will be updated.')
        } else {
          const res = await api.submitRedeem({amount:amt})
          if(res.success) await init()
          else alert(res.message || 'Redeem failed')
        }
      } catch(err){ console.error(err); alert('Payment initiation failed — try again') }

      closeModal()
    })

    function showDetail(inv){
      const lines = [`Title: ${inv.title}`, `Amount: ${fmt(inv.amount)}`, `Rate: ${(inv.rate*100).toFixed(2)}% p.a.`, inv.extra || '']
      // In production, replace alert with a modal details overlay
      alert(lines.join('
'))
    }

    // estimator
    document.getElementById('calcBtn').addEventListener('click',async ()=>{
      const amt = Number(document.getElementById('estAmount').value)
      const r = Number(document.getElementById('estRate').value)/100
      const y = Number(document.getElementById('estYears').value)
      try{
        const res = await api.estimate({amount:amt,rate:r,years:y})
        if(res && res.projected){ document.getElementById('estResult').innerHTML = `<div style="font-weight:800;margin-top:8px">Projected: ${fmt(res.projected)} (server-calculated)</div>` }
        else { const future = amt * Math.pow(1 + r, y); document.getElementById('estResult').innerHTML = `<div style="font-weight:800;margin-top:8px">Projected: ${fmt(future)} (client calc)</div>` }
      } catch(err){ console.error(err); alert('Estimator failed') }
    })

    document.getElementById('learnBtn').addEventListener('click',()=>{
      alert('How it works:
1) You invest via a secure payment provider.
2) InvestX records the pending deposit and validates the payment via webhook.
3) Funds are custodied with third-party custodians; returns are calculated server-side.

We use industry-standard custody, SOC2 controls, KYC, and AML processes.')
    })

    // Polling or websocket can be implemented to refresh portfolio after payments; simple interval re-fetch below
    setInterval(()=>{ init() }, 30_000) // refresh every 30s
    init()
  </script></body>
</html>
